# Лабораторная работа 5: Алгоритмы отсечения отрезков и многоугольников

# 1 Общее описание

## 1.1 Основные возможности

Программа "Отсечение отрезков" предназначена для визуализации и демонстрации работы алгоритмов отсечения геометрических объектов.

Программа позволяет:
- Загружать данные из текстового файла в заданном формате
- Отображать систему координат с отсечками и значениями
- Визуализировать отсекающее окно и исходные отрезки
- Выполнять отсечение отрезков алгоритмом Коэна-Сазерленда
- Отображать видимые части отрезков после отсечения
- Автоматически масштабировать сцену для удобного просмотра

## 1.2 Алгоритмы отсечения

### Алгоритм Коэна-Сазерленда
**Тип алгоритма:** Кодирование областей  
**Принцип работы:**
- Каждая конечная точка отрезка кодируется 4-битным кодом
- Код определяет положение точки относительно отсекающего окна
- Быстрое определение полностью видимых и полностью невидимых отрезков
- Поэтапное отсечение невидимых частей

**Области кодирования:**
```
1001 | 1000 | 1010
-----|------|-----
0001 | 0000 | 0010
-----|------|-----
0101 | 0100 | 0110
```

**Применение:** Графические системы, САПР  
**Особенности в программе:** Реализация через явное задание прямой

# 2 Руководство пользователя

## 2.1 Запуск программы

Программа написана на Python с использованием PySide6 и запускается следующим образом:

```bash
python main.py
```

**Системные требования:**
- Python 3.7+
- PySide6
- NumPy

**Установка зависимостей:**
```bash
pip install PySide6 numpy
```

## 2.2 Основные элементы интерфейса

**Графическая область:**
- Черный фон с белыми осями координат
- Автоматическая система координат с отсечками
- Масштабирование, обеспечивающее видимость всех объектов
- Подписи значений на осях координат

**Элементы управления:**
- Кнопка "Загрузить файл" - открытие диалога выбора файла
- Кнопка "Сброс" - очистка текущей сцены
- Строка состояния - отображение информации о загруженном файле

**Цветовая схема:**
- Отсекающее окно: голубой цвет (0, 255, 255)
- Исходные отрезки: красный цвет (255, 100, 100)
- Отсеченные части: зеленый цвет (100, 255, 100)

## 2.3 Формат входного файла

Программа поддерживает следующий формат текстового файла:

```
n
x1_1 y1_1 x2_1 y2_1
x1_2 y1_2 x2_2 y2_2
...
x1_n y1_n x2_n y2_n
xmin ymin xmax ymax
```

**Пример файла:**
```
3
10 10 100 100
50 50 150 150
30 70 120 20
20 20 120 120
```

## 2.4 Работа с программой

**Загрузка данных:**
1. Нажмите кнопку "Загрузить файл"
2. Выберите текстовый файл с данными
3. Программа автоматически загрузит данные и выполнит отсечение

**Просмотр результатов:**
- Отсекающее окно отображается как голубой прямоугольник
- Исходные отрезки показаны тонкими красными линиями
- Видимые части отрезков показаны толстыми зелеными линиями

**Особенности работы:**
- Система координат автоматически масштабируется
- Отсечки на осях показывают числовые значения
- При изменении размера окна масштаб пересчитывается

# 3 Структура и архитектура приложения

## 3.1 Структура проекта

Программа реализована в объектно-ориентированном стиле с четким разделением ответственности:

```
ClipApp/
├── main.py              # Главный файл с интерфейсом
├── ClipArea.py          # Логика отсечения
└── GraphicsWidget.py    # Графическая визуализация
```

## 3.2 Взаимодействие компонентов

```
MainWindow (Интерфейс)
         ↑
         | События загрузки
         ↓
   GraphicsWidget (Визуализация)
         ↑
         | Данные отсечения  
         ↓
    ClipArea (Алгоритмы)
```

## 3.3 Анализ кода

**Основные классы:**

1. **ClipArea** - реализация алгоритма отсечения:
```python
class ClipArea:
    def __init__(self):
        self.reset()
    
    def cohen_sutherland_clip(self):
        # Реализация алгоритма Коэна-Сазерленда
```

2. **GraphicsWidget** - визуализация и преобразование координат:
```python
class GraphicsWidget(QWidget):
    def __init__(self):
        # Инициализация графического виджета
    
    def auto_scale(self):
        # Автоматический расчет масштаба
```

3. **MainWindow** - главное окно с элементами управления:
```python
class MainWindow(QMainWindow):
    def __init__(self):
        # Создание интерфейса
```

**Ключевые алгоритмы:**

**Алгоритм Коэна-Сазерленда:**
```python
def compute_outcode(self, x, y):
    # Вычисление кода области для точки
    code = 0
    if x < xmin: code |= 1   # Слева
    elif x > xmax: code |= 2 # Справа
    if y < ymin: code |= 4   # Снизу
    elif y > ymax: code |= 8 # Сверху
    return code
```

**Автоматическое масштабирование:**
```python
def auto_scale(self):
    # Находит границы всех объектов
    # Вычисляет оптимальный масштаб
    # Центрирует сцену
```

## 3.4 Решенные проблемы

### Решенные проблемы:

**1. Автоматическое масштабирование сцены**
- *Проблема:* Объекты могут выходить за границы экрана
- *Решение:* Реализация `auto_scale()`, которая автоматически рассчитывает масштаб для видимости всех объектов

**2. Отображение системы координат с отсечками**
- *Проблема:* Необходимость показа числовых значений на осях
- *Решение:* Автоматический расчет шага сетки и отрисовка отсечек с подписями

**3. Преобразование координат**
- *Проблема:* Переход от мировых координат к экранным
- *Решение:* Реализация методов `transform_point()` и `inverse_transform()`

**4. Работа с файлами**
- *Проблема:* Чтение данных в заданном формате
- *Решение:* Парсинг текстового файла с проверкой ошибок

### Нерешенные проблемы:

**1. Поддержка других алгоритмов отсечения**
- *Проблема:* В программе реализован только алгоритм Коэна-Сазерленда
- *Текущее состояние:* Отсутствуют алгоритмы Лианга-Барски и средней точки

**2. Отсечение многоугольников**
- *Проблема:* Программа работает только с отрезками
- *Текущее состояние:* Отсутствует поддержка алгоритма отсечения многоугольников

**3. Интерактивное редактирование**
- *Проблема:* Отсутствие возможности изменять объекты вручную
- *Текущее состояние:* Только загрузка из файла

# 4 Реализованные технологии

Программа разработана с использованием следующих технологий:

- **Python 3.10+** - основной язык программирования
- **PySide6 (Qt для Python)** - графический интерфейс
- **NumPy** - математические операции
- **Алгоритм Коэна-Сазерленда** - основной алгоритм отсечения
- **Система автоматического масштабирования** - адаптивная визуализация

## Архитектурные решения:

1. **Разделение логики и интерфейса** - классы `ClipArea` и `GraphicsWidget` независимы
2. **Автоматическое масштабирование** - сцена всегда оптимально помещается в окне
3. **Гибкая система координат** - поддержка любого диапазона значений
4. **Расширяемая архитектура** - возможность добавления новых алгоритмов

## Особенности реализации:

**Производительность:**
- Минимальные перерисовки при обновлении
- Оптимизированные математические операции
- Эффективное использование памяти

**Надежность:**
- Обработка ошибок при чтении файлов
- Проверка корректности данных
- Стабильная работа при различных входных данных

**Пользовательский опыт:**
- Интуитивно понятный интерфейс
- Автоматическая настройка отображения
- Четкая цветовая дифференциация объектов

# 5 Заключение

В ходе выполнения лабораторной работы была разработана программа для визуализации алгоритма отсечения отрезков. Программа успешно демонстрирует работу алгоритма Коэна-Сазерленда и предоставляет удобный интерфейс для работы с геометрическими данными.

**Достигнутые цели:**
- Реализован алгоритм отсечения Коэна-Сазерленда
- Создан графический интерфейс с системой координат
- Реализована загрузка данных из файла
- Обеспечена визуализация всех этапов отсечения
- Реализовано автоматическое масштабирование

**Возможные улучшения:**
1. Добавление других алгоритмов отсечения
2. Поддержка отсечения многоугольников
3. Интерактивное создание и редактирование объектов
4. Экспорт результатов в различные форматы
5. Анимация процесса отсечения

Программа соответствует всем требованиям лабораторной работы и может использоваться для изучения алгоритмов отсечения в компьютерной графике.